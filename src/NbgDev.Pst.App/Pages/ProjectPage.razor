@page "/project/{Id:guid}"
@using NbgDev.Pst.App.Components

<h3>Project</h3>

@if (Project is null)
{
    <MudText>No project with ID @Id found.</MudText>
}
else
{
    <MudPaper Class="pa-4 mb-4">
        <MudText Typo="Typo.h6">@Project.Name</MudText>
        <MudText>ID: @Project.Id</MudText>
        <MudText>Short Name: @Project.ShortName</MudText>
    </MudPaper>

    <MudTabs Elevation="2" Rounded="true" ApplyEffectsToContainer="true">
        <MudTabPanel Text="Members">
            <MembersPanel ProjectId="@Id" />
        </MudTabPanel>
        <MudTabPanel Text="Permissions">
            <div class="pa-4">
                @if (Project.Group != null)
                {
                    <MudText Typo="Typo.h6" Class="mb-2">Project Security Group</MudText>
                    <MudText><strong>Group Name:</strong> @Project.Group.Name</MudText>
                    <MudText><strong>Group ID:</strong> @Project.Group.Id</MudText>
                }
                else
                {
                    <MudText>No security group has been created yet for this project.</MudText>
                }
            </div>
        </MudTabPanel>
        <MudTabPanel Text="Settings">
            <div class="pa-4">
                <MudText Typo="Typo.h6" Class="mb-4">Danger Zone</MudText>
                <MudButton Color="Color.Error" 
                           Variant="Variant.Filled" 
                           OnClick="OpenDeleteDialog"
                           StartIcon="@Icons.Material.Filled.Delete">
                    Delete Project
                </MudButton>
            </div>
        </MudTabPanel>
    </MudTabs>

    <div class="mt-4">
        <MudButton OnClick="GoHome">Go home</MudButton>
    </div>
}

<MudDialog @bind-Visible="deleteDialogVisible" Options="dialogOptions">
    <TitleContent>
        <MudText Typo="Typo.h6">
            <MudIcon Icon="@Icons.Material.Filled.Warning" Class="mr-3" Color="Color.Warning" /> Confirm Deletion
        </MudText>
    </TitleContent>
    <DialogContent>
        <MudText>Are you sure you want to delete the project <strong>@Project?.Name</strong>?</MudText>
        <MudText Class="mt-2">This action cannot be undone. The project and its associated security group will be permanently deleted.</MudText>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="CloseDeleteDialog">Cancel</MudButton>
        <MudButton Color="Color.Error" Variant="Variant.Filled" OnClick="DeleteProject">Delete</MudButton>
    </DialogActions>
</MudDialog>
